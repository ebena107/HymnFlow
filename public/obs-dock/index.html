<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>HymnFlow OBS Dock</title>
  <link rel="stylesheet" href="obs-dock.css">
</head>
<body>
  <div class="app">
    <!-- Header with Status Indicator -->
    <header class="header">
      <div class="title-block">
        <div class="title">HymnFlow Dock</div>
        <div class="subtitle">Lower-third controller for OBS HYMN</div>
      </div>
      <div class="status-indicator">
        <div class="status-badge" aria-label="Storage type">localStorage</div>
        <div role="status" aria-live="polite" aria-atomic="true" id="status" class="status-live">LIVE</div>
      </div>
    </header>

    <!-- Main Vertical Container -->
    <div class="vertical-container">
      
      <!-- Hymns Section -->
      <section class="section">
        <div class="section-header">
          <h3>Hymns</h3>
          <div class="action-group">
            <button id="btnAdd" class="btn btn-add" aria-label="Add new hymn" title="Add new hymn">+ Add</button>
            <button id="btnEdit" class="btn btn-secondary" aria-label="Edit selected hymn" title="Edit selected hymn">✏️ Edit</button>
            <button id="btnRemove" class="btn btn-remove" aria-label="Remove selected hymn" title="Remove selected hymn">- Remove</button>
          </div>
        </div>
        <label for="search" class="sr-only">Search hymns by title, author, or number</label>
        <input id="search" type="text" class="search-input" placeholder="Search hymns" aria-label="Search hymns by title, author, or number">
        <div id="hymnList" class="hymn-list" role="listbox" aria-label="Hymns library"></div>
        <div class="import-export-actions">
          <button id="btnImport" class="btn btn-secondary" aria-label="Import hymns from file" title="Import hymns from TXT or JSON file">Import</button>
          <button id="btnExport" class="btn btn-secondary" aria-label="Export hymns to JSON file" title="Export all hymns to JSON file">Export</button>
          <input type="file" id="fileInput" accept=".txt,.json" hidden aria-label="Select hymn file to import">
        </div>
      </section>

      <!-- Services/Scheduling Section -->
      <section class="section">
        <div class="section-header">
          <h3>Services</h3>
          <button id="btnNewService" class="btn btn-add" style="margin: 0;" aria-label="Create new service" title="Create new service">+ New</button>
        </div>
        <div id="servicesList" class="services-list" role="list" aria-label="Saved services"></div>
        <div id="serviceEditor" class="service-editor" style="display: none;">
          <input id="serviceName" type="text" class="search-input" placeholder="Service name (e.g., Sunday Morning)">
          <div id="serviceHymns" class="service-hymns"></div>
          <div style="display: flex; gap: 8px; margin-top: 10px;">
            <button id="btnAddToService" class="btn btn-secondary">+ Add Hymn</button>
            <button id="btnSaveService" class="btn btn-add">Save Service</button>
            <button id="btnCancelService" class="btn btn-secondary">Cancel</button>
          </div>
        </div>
      </section>

      <!-- Selected Hymn Controls -->
      <section class="section">
        <div class="section-header-single">
          <h3 id="currentTitle">Selected Hymn Title</h3>
          <div class="verse-info" id="verseInfo">Verse 1/4 · Lines 1-2 of 4</div>
        </div>
        
        <div class="navigation-controls">
          <button id="btnPrevVerse" class="btn btn-nav" aria-label="Go to previous verse" title="Previous verse (Left arrow)">⟵ Previous</button>
          <button id="btnNextVerse" class="btn btn-nav" aria-label="Go to next verse" title="Next verse (Right arrow)">Next ⟶</button>
          <button id="btnPrevLine" class="btn btn-nav" aria-label="Show previous lines" title="Previous line window (Up arrow)">⬆ Previous Line</button>
          <button id="btnNextLine" class="btn btn-nav" aria-label="Show next lines" title="Next line window (Down arrow)">⬇ Next Line</button>
          <button id="btnJumpChorus" class="btn btn-nav btn-chorus" aria-label="Jump to chorus" title="Display chorus if available">Jump to Chorus</button>
          <button id="btnClear" class="btn btn-emergency" aria-label="Emergency clear overlay" title="Immediately hide overlay from stream">Emergency Clear</button>
        </div>
      </section>

      <!-- Display Controls -->
      <section class="section">
        <div class="display-controls">
          <div class="display-toggle">
            <label class="toggle-switch" for="displayToggle">
              <input type="checkbox" id="displayToggle" aria-label="Toggle overlay display">
              <span class="toggle-slider"></span>
            </label>
            <span class="toggle-label">Display</span>
            <span class="live-indicator" id="liveIndicator" role="status" aria-live="polite">LIVE</span>
          </div>
          <button id="btnReset" class="btn btn-secondary" aria-label="Reset to verse 1" title="Reset to first verse, first line">Reset</button>
        </div>
        
        <div class="lines-control">
          <label class="control-label" for="linesPerPage">Lines per display</label>
          <div class="slider-container">
            <span class="slider-value" aria-hidden="true">2</span>
            <input type="range" id="linesPerPage" min="2" max="6" value="2" class="slider" aria-label="Lines per display" aria-valuemin="2" aria-valuemax="6" aria-valuenow="2">
            <div class="slider-marks">
              <span>2</span>
              <span>3</span>
              <span>4</span>
              <span>5</span>
              <span>6</span>
            </div>
          </div>
        </div>
      </section>

      <!-- Hymn Preview -->
      <section class="section">
        <h4 class="preview-title">Hymn Previews</h4>
        <div id="preview" class="preview"></div>
      </section>

      <!-- Styles Section -->
      <section class="section">
        <h3>Styles</h3>
        <div class="styles-form">
          <label class="form-label">
            Font Family
            <select id="fontFamily" class="form-select">
              <option value="Inter, sans-serif">Inter</option>
              <option value="'Segoe UI', sans-serif">Segoe UI</option>
              <option value="'Roboto', sans-serif">Roboto</option>
              <option value="'Georgia', serif">Georgia</option>
              <option value="'Montserrat', sans-serif">Montserrat</option>
            </select>
          </label>
          
          <label class="form-label">
            Font size <span id="fontSizeValue">48px</span>
            <input type="range" id="fontSize" min="24" max="96" value="48" class="form-slider">
          </label>
          
          <div class="style-options">
            <label class="checkbox-label"><input type="checkbox" id="bold"> Bold</label>
            <label class="checkbox-label"><input type="checkbox" id="italic"> Italic</label>
            <label class="checkbox-label"><input type="checkbox" id="shadow"> Shadow</label>
            <label class="checkbox-label"><input type="checkbox" id="glow"> Glow</label>
            <label class="checkbox-label"><input type="checkbox" id="outline"> Outline</label>
          </div>
          
          <div id="outlineControls" class="outline-controls" style="display: none;">
            <label class="form-label">
              Outline Color
              <input type="color" id="outlineColor" value="#000000" class="form-color">
            </label>
            
            <label class="form-label">
              Outline Width <span id="outlineWidthValue">2px</span>
              <input type="range" id="outlineWidth" min="1" max="5" value="2" class="form-slider">
            </label>
          </div>
          
          <label class="form-label">
            Text Color
            <input type="color" id="textColor" value="#ffffff" class="form-color">
          </label>
          
          <label class="form-label">
            Background type
            <select id="bgType" class="form-select">
              <option value="transparent">Transparent</option>
              <option value="solid">Solid</option>
              <option value="gradient">Gradient</option>
            </select>
          </label>
          
          <label class="form-label">
            Background color A
            <input type="color" id="bgColorA" value="#000000" class="form-color">
          </label>
          
          <label class="form-label bg-gradient">
            Background color B (for gradient)
            <input type="color" id="bgColorB" value="#2b2b2b" class="form-color">
          </label>
          
          <label class="form-label">
            Animation
            <select id="animation" class="form-select">
              <option value="fade">Fade</option>
              <option value="slide">Slide</option>
              <option value="none">None</option>
            </select>
          </label>
          
          <label class="form-label">
            Position
            <select id="position" class="form-select">
              <option value="bottom">Bottom Third</option>
              <option value="middle">Middle</option>
              <option value="top">Top</option>
            </select>
          </label>
        </div>
      </section>

    </div>
  </div>

  <!-- Edit Hymn Modal -->
  <div id="editModal" class="modal" style="display: none;">
    <div class="modal-content">
      <div class="modal-header">
        <h3 id="modalTitle">Edit Hymn</h3>
        <button id="btnCloseModal" class="btn-close">&times;</button>
      </div>
      <div class="modal-body">
        <label class="form-label">
          Hymn Number
          <input type="number" id="editNumber" class="form-input" placeholder="e.g., 123">
        </label>
        <label class="form-label">
          Source Abbreviation
          <input type="text" id="editSourceAbbr" class="form-input" placeholder="e.g., CH, PD, HB" maxlength="5">
        </label>
        <label class="form-label">
          Source Name
          <input type="text" id="editSource" class="form-input" placeholder="e.g., Church Hymnal, Public Domain">
        </label>
        <label class="form-label">
          Title *
          <input type="text" id="editTitle" class="form-input" placeholder="Hymn title" required>
        </label>
        <label class="form-label">
          Author
          <input type="text" id="editAuthor" class="form-input" placeholder="Author name">
        </label>
        <label class="form-label">
          Verses * (separate verses with blank line)
          <textarea id="editVerses" class="form-textarea" rows="10" placeholder="Verse 1 text&#10;&#10;Verse 2 text&#10;&#10;Verse 3 text" required></textarea>
        </label>
        <label class="form-label">
          Chorus (optional)
          <textarea id="editChorus" class="form-textarea" rows="3" placeholder="Chorus text"></textarea>
        </label>
      </div>
      <div class="modal-footer">
        <button id="btnCancelEdit" class="btn btn-secondary">Cancel</button>
        <button id="btnSaveEdit" class="btn btn-add">Save Changes</button>
      </div>
    </div>
  </div>

  <script src="../data/hymns-data.js"></script>
  <script src="../validation.js"></script>
  <script src="../parsers/txtParser.js"></script>
  <script src="../parsers/jsonParser.js"></script>
  <script src="obs-dock.js"></script>
</body>
</html>
